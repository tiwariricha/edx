{"version":3,"sources":["webpack:///./openedx/features/course_experience/static/course_experience/js/CourseHome.js"],"names":["CourseHome","options","courseRunKey","msgStateStorageKey","$resumeCourseLink","$","resumeCourseLink","on","event","eventType","find","data","Logger","log","event_type","url","currentTarget","href","$courseToolLink","courseToolLink","courseToolName","srcElement","dataset","tool_name","$goalSection","$editGoalIcon","$currentGoalText","$goalSelect","$responseIndicator","$responseMessageSr","$goalUpdateTitle","$goalUpdateLabel","target","hasClass","toggle","removeClass","addClass","focus","document","body","which","trigger","show","hide","type","newGoalKey","val","ajax","method","goalApiUrl","headers","cookie","goal_key","course_key","courseId","user","username","dataType","success","text","goal_text","gettext","error","complete","setTimeout","closest","ready","configureUpgradeMessage","configureUpgradeAnalytics","each","index","button","promotionEventProperties","promotion_id","creative","name","position","fireSegmentEvent","click","logEventProperties","location","scrollIntoView","behavior","alignToTop","properties","window","analytics","track"],"mappings":"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","file":"CourseHome.js","sourcesContent":["/* globals gettext, Logger */\n\nexport class CourseHome {  // eslint-disable-line import/prefer-default-export\n  constructor(options) {\n    this.courseRunKey = options.courseRunKey;\n    this.msgStateStorageKey = `course_experience.upgrade_msg.${this.courseRunKey}.collapsed`;\n\n    // Logging for 'Resume Course' or 'Start Course' button click\n    const $resumeCourseLink = $(options.resumeCourseLink);\n    $resumeCourseLink.on('click', (event) => {\n      const eventType = $resumeCourseLink.find('span').data('action-type');\n      Logger.log(\n        'edx.course.home.resume_course.clicked',\n        {\n          event_type: eventType,\n          url: event.currentTarget.href,\n        },\n      );\n    });\n\n    // Logging for course tool click events\n    const $courseToolLink = $(options.courseToolLink);\n    $courseToolLink.on('click', (event) => {\n      const courseToolName = event.srcElement.dataset['analytics-id']; // eslint-disable-line dot-notation\n      Logger.log(\n        'edx.course.tool.accessed',\n        {\n          tool_name: courseToolName,\n        },\n      );\n    });\n\n    // Course goal editing elements\n    const $goalSection = $('.section-goals');\n    const $editGoalIcon = $('.section-goals .edit-icon');\n    const $currentGoalText = $('.section-goals .goal');\n    const $goalSelect = $('.section-goals .edit-goal-select');\n    const $responseIndicator = $('.section-goals .response-icon');\n    const $responseMessageSr = $('.section-goals .sr-update-response-msg');\n    const $goalUpdateTitle = $('.section-goals .title:not(\"label\")');\n    const $goalUpdateLabel = $('.section-goals label.title');\n\n    // Switch to editing mode when the goal section is clicked\n    $goalSection.on('click', (event) => {\n      if (!$(event.target).hasClass('edit-goal-select')) {\n        $goalSelect.toggle();\n        $currentGoalText.toggle();\n        $goalUpdateTitle.toggle();\n        $goalUpdateLabel.toggle();\n        $responseIndicator.removeClass().addClass('response-icon');\n        $goalSelect.focus();\n      }\n    });\n\n    // Trigger click event on enter press for accessibility purposes\n    $(document.body).on('keyup', '.section-goals .edit-icon', (event) => {\n      if (event.which === 13) {\n        $(event.target).trigger('click');\n      }\n    });\n\n    // Send an ajax request to update the course goal\n    $goalSelect.on('blur change', (event) => {\n      $currentGoalText.show();\n      $goalUpdateTitle.show();\n      $goalUpdateLabel.hide();\n      $goalSelect.hide();\n      // No need to update in the case of a blur event\n      if (event.type === 'blur') return;\n      const newGoalKey = $(event.target).val();\n      $responseIndicator.removeClass().addClass('response-icon fa fa-spinner fa-spin');\n      $.ajax({\n        method: 'POST',\n        url: options.goalApiUrl,\n        headers: { 'X-CSRFToken': $.cookie('csrftoken') },\n        data: {\n          goal_key: newGoalKey,\n          course_key: options.courseId,\n          user: options.username,\n        },\n        dataType: 'json',\n        success: (data) => {\n          $currentGoalText.find('.text').text(data.goal_text);\n          $responseMessageSr.text(gettext('You have successfully updated your goal.'));\n          $responseIndicator.removeClass().addClass('response-icon fa fa-check');\n        },\n        error: () => {\n          $responseIndicator.removeClass().addClass('response-icon fa fa-close');\n          $responseMessageSr.text(gettext('There was an error updating your goal.'));\n        },\n        complete: () => {\n          // Only show response icon indicator for 3 seconds.\n          setTimeout(() => {\n            $responseIndicator.removeClass().addClass('response-icon');\n          }, 3000);\n          $editGoalIcon.focus();\n        },\n      });\n    });\n\n    // Dismissibility for in course messages\n    $(document.body).on('click', '.course-message .dismiss', (event) => {\n      $(event.target).closest('.course-message').hide();\n    });\n\n    // Allow dismiss on enter press for accessibility purposes\n    $(document.body).on('keyup', '.course-message .dismiss', (event) => {\n      if (event.which === 13) {\n        $(event.target).trigger('click');\n      }\n    });\n\n    $(document).ready(() => {\n      this.configureUpgradeMessage();\n      this.configureUpgradeAnalytics();\n    });\n  }\n\n  static fireSegmentEvent(event, properties) {\n    /* istanbul ignore next */\n    if (!window.analytics) {\n      return;\n    }\n\n    window.analytics.track(event, properties);\n  }\n\n  // Promotion analytics for upgrade messages on course home.\n  // eslint-disable-next-line class-methods-use-this\n  configureUpgradeAnalytics() {\n    $('.btn-upgrade').each(\n      (index, button) => {\n        const promotionEventProperties = {\n          promotion_id: 'courseware_verified_certificate_upsell',\n          creative: $(button).data('creative'),\n          name: 'In-Course Verification Prompt',\n          position: $(button).data('position'),\n        };\n        CourseHome.fireSegmentEvent('Promotion Viewed', promotionEventProperties);\n        $(button).click(() => {\n          CourseHome.fireSegmentEvent('Promotion Clicked', promotionEventProperties);\n        });\n      },\n    );\n  }\n\n  configureUpgradeMessage() {\n    const logEventProperties = { courseRunKey: this.courseRunKey };\n\n    Logger.log('edx.bi.course.upgrade.sidebarupsell.displayed', logEventProperties);\n    $('.section-upgrade .btn-upgrade').click(() => {\n      Logger.log('edx.bi.course.upgrade.sidebarupsell.clicked', logEventProperties);\n      Logger.log('edx.course.enrollment.upgrade.clicked', { location: 'sidebar-message' });\n    });\n    $('.promo-learn-more').click(() => {\n      $('.action-toggle-verification-sock').click();\n      $('.action-toggle-verification-sock')[0].scrollIntoView({ behavior: 'smooth', alignToTop: true });\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./openedx/features/course_experience/static/course_experience/js/CourseHome.js"],"sourceRoot":""}